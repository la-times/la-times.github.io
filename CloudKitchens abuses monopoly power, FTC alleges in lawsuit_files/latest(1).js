(()=>{var e={296:(e,t,i)=>{var n=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,r=/^0o[0-7]+$/i,a=parseInt,c="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,l="object"==typeof self&&self&&self.Object===Object&&self,d=c||l||Function("return this")(),u=Object.prototype.toString,h=Math.max,m=Math.min,p=function(){return d.Date.now()};function v(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(v(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=v(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var i=o.test(e);return i||r.test(e)?a(e.slice(2),i?2:8):s.test(e)?NaN:+e}e.exports=function(e,t,i){var n,s,o,r,a,c,l=0,d=!1,u=!1,b=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var i=n,o=s;return n=s=void 0,l=t,r=e.apply(o,i)}function w(e){return l=e,a=setTimeout(x,t),d?f(e):r}function y(e){var i=e-c;return void 0===c||i>=t||i<0||u&&e-l>=o}function x(){var e=p();if(y(e))return E(e);a=setTimeout(x,function(e){var i=t-(e-c);return u?m(i,o-(e-l)):i}(e))}function E(e){return a=void 0,b&&n?f(e):(n=s=void 0,r)}function T(){var e=p(),i=y(e);if(n=arguments,s=this,c=e,i){if(void 0===a)return w(c);if(u)return a=setTimeout(x,t),f(c)}return void 0===a&&(a=setTimeout(x,t)),r}return t=g(t)||0,v(i)&&(d=!!i.leading,o=(u="maxWait"in i)?h(g(i.maxWait)||0,t):o,b="trailing"in i?!!i.trailing:b),T.cancel=function(){void 0!==a&&clearTimeout(a),l=0,n=c=s=a=void 0},T.flush=function(){return void 0===a?r:E(p())},T}}},t={};function i(n){var s=t[n];if(void 0!==s)return s.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,i),o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=i(296),t=i.n(e);const n=[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/BB/i,/PlayBook/i,/IEMobile/i,/Windows Phone/i,/Kindle/i,/Silk/i,/Opera Mini/i];class s{constructor(e){this.enabled=!0,this.timeIdle=0,this.userIsActive=!0,this.userWasInactive=!1,this.inactivityDuration=0,this.reactivityDuration=0,this.trackActivityInterval=null,this.exitDelayTimer=null,this.settings={exitTargetElement:"body",exitDelay:0,exitSensitivity:10,idleThreshold:7,inactivityThreshold:60,reactivityThreshold:30,disableDesktopExitIntent:!1,disableMobileExitIntent:!1,disableRewindLandingPage:!1,endTargetElement:"footer.page-footer",bounceAction:null,probability:1,debug:!1},this.mobileOriginalPosition=0,this.isMobileTouchMoveListening=!1,this.isMobileTouchEndListening=!1,this.isMobile=!1,this.settings=Object.assign(Object.assign({},this.settings),e),(this.settings.probability>1||this.settings.probability<=0||!this.settings.probability)&&(this.settings.probability=1),this.isMobile=n.some((e=>navigator.userAgent.match(e))),this.activityEventListener=t()((e=>{this.setUserIsActive(e)}),100),this.settings.disableDesktopExitIntent||(this.mouseExitIntentListener=this.handleMouseExitIntent.bind(this)),this.settings.disableMobileExitIntent||(this.mobileActivityEventListener=t()((e=>{this.handleMobileActivity(e)}),100),this.mobileTouchMoveListener=this.mobileTouchMoveHandler.bind(this),this.mobileTouchEndListener=this.mobileTouchEndHandler.bind(this)),this.exitTargetEl=document.querySelector(this.settings.exitTargetElement)||void 0,this.endTargetEl=document.querySelector(this.settings.endTargetElement)||void 0,this.enabled&&this.init()}init(){this.settings.debug&&console.debug("BounceTracker.init"),window.addEventListener("click",this.activityEventListener),window.addEventListener("keypress",this.activityEventListener),this.isMobile&&!this.settings.disableMobileExitIntent?(window.addEventListener("scroll",this.mobileActivityEventListener),window.addEventListener("touchstart",this.mobileActivityEventListener,{passive:!0})):(window.addEventListener("mousemove",this.activityEventListener,{passive:!0}),window.addEventListener("mousedown",this.activityEventListener),window.addEventListener("scroll",this.activityEventListener),this.exitTargetEl&&!this.settings.disableDesktopExitIntent&&(this.exitTargetEl.addEventListener("mouseleave",this.mouseExitIntentListener),this.exitTargetEl.addEventListener("mouseenter",this.mouseExitIntentListener))),this.trackActivityInterval=this.trackActivity(),this.endTargetEl&&this.handleEndTargetVisibility()}setUserIsActive(e){this.settings.debug&&console.debug("BounceTracker.setUserIsActive: event.type",e.type),this.userIsActive=!0,this.timeIdle=0,this.inactivityDuration=0}trackActivity(){return setInterval((()=>{this.settings.debug&&(console.debug("BounceTracker.userIsActive",this.userIsActive),console.debug("BounceTracker.userWasIdle",this.userWasInactive),console.debug("BounceTracker.timeIdle, threshold",this.timeIdle,this.settings.idleThreshold),console.debug("BounceTracker.inactivityDuration, limit",this.inactivityDuration,this.settings.inactivityThreshold),console.debug("BounceTracker.reactivityDuration, limit",this.reactivityDuration,this.settings.reactivityThreshold)),this.userIsActive?(this.userIsActive=!1,this.userWasInactive&&(this.reactivityDuration++,this.reactivityDuration>=this.settings.reactivityThreshold&&this.triggerBounceAction())):(this.timeIdle<this.settings.idleThreshold?this.timeIdle++:(this.userWasInactive=!0,this.inactivityDuration++),this.inactivityDuration>=this.settings.inactivityThreshold&&this.triggerBounceAction())}),1e3)}handleMouseExitIntent(e){if(this.settings.debug&&console.debug("BounceTracker.handleMouseLeaveIntent",e.type),"mouseleave"===e.type){if(this.settings.debug&&console.debug("MouseLeave, clientY, sensitivity",e.clientY,this.settings.exitSensitivity),e.clientY>=this.settings.exitSensitivity)return;this.exitDelayTimer=setTimeout((()=>{this.triggerBounceAction()}),this.settings.exitDelay)}"mouseenter"===e.type&&this.exitDelayTimer&&(clearTimeout(this.exitDelayTimer),this.exitDelayTimer=null)}mobileTouchMoveHandler(){this.settings.debug&&console.log("mobileTouchMoveHandler",event),this.isMobileTouchEndListening||(this.isMobileTouchEndListening=!0,window.addEventListener("touchend",this.mobileTouchEndListener,{passive:!0}))}mobileTouchEndHandler(){this.settings.debug&&console.log("mobileTouchEndHandler",event);const e=this.mobileOriginalPosition-window.scrollY;e>0&&e<200&&this.triggerBounceAction(),window.removeEventListener("touchend",this.mobileTouchEndListener,!1),window.removeEventListener("touchmove",this.mobileTouchMoveListener,!1),this.isMobileTouchEndListening=!1,this.isMobileTouchMoveListening=!1}handleMobileActivity(e){this.settings.debug&&console.log("handleMobileActivity",e),this.setUserIsActive(e),this.isMobileTouchMoveListening||(this.mobileOriginalPosition=window.scrollY,this.isMobileTouchMoveListening=!0,window.addEventListener("touchmove",this.mobileTouchMoveListener,{passive:!0}))}handleEndTargetVisibility(){var e;if(this.settings.debug&&console.debug("handleEndTargetVisibility",this.endTargetEl),this.endTargetEl&&"IntersectionObserver"in window&&"intersectionRatio"in(null===(e=window.IntersectionObserverEntry)||void 0===e?void 0:e.prototype)){const e={threshold:0};this.observer=new IntersectionObserver(((e,t)=>{this.settings.debug&&console.debug("Observed elements:",t,e),e[0].isIntersecting&&(this.settings.debug&&console.debug("Observed intersection on target:",this.endTargetEl),this.triggerBounceAction())}),e),this.observer.observe(this.endTargetEl)}}triggerBounceAction(){let e;if(this.settings.debug&&console.debug("triggerBounceAction, enabled",this.enabled,this.settings.bounceAction),1===this.settings.probability)e=!0;else{const t=Math.random();this.settings.debug&&console.debug("Using probability, chance",this.settings.probability,t),e=t<this.settings.probability}this.enabled&&e&&this.settings.bounceAction&&this.settings.bounceAction(),this.disable()}disable(){if(this.enabled=!1,window.removeEventListener("click",this.activityEventListener),window.removeEventListener("keypress",this.activityEventListener),this.isMobile)window.removeEventListener("scroll",this.mobileActivityEventListener),window.removeEventListener("touchstart",this.mobileActivityEventListener,!1),window.removeEventListener("touchend",this.mobileTouchEndListener,!1),window.removeEventListener("touchmove",this.mobileTouchMoveListener,!1);else if(window.removeEventListener("mousemove",this.activityEventListener,!1),window.removeEventListener("mousedown",this.activityEventListener),window.removeEventListener("scroll",this.activityEventListener),this.exitTargetEl){const e=this.exitTargetEl;e.removeEventListener("mouseleave",this.mouseExitIntentListener),e.removeEventListener("mouseenter",this.mouseExitIntentListener)}this.trackActivityInterval&&clearInterval(this.trackActivityInterval),this.observer&&this.observer.disconnect()}}const o=e=>{"function"==typeof window.CustomEvent&&window.dispatchEvent(new window.CustomEvent(`NewsletterCampaign:${e}`,{bubbles:!0}))},r=(e,...t)=>{var i,n;((null===(i=window.newsletterCampaignSettings)||void 0===i?void 0:i.debug)||(null===(n=window.ncm)||void 0===n?void 0:n.isDebug))&&console.debug(`NCM: ${e}`,t)};var a,c,l=function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function r(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))};class d{static buildHtmlElement(e){const t=`\n      <style>.visually-hidden{clip:rect(0 0 0 0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.visually-hidden-undo,.visually-hidden.focusable:active,.visually-hidden.focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}*{box-sizing:border-box;color:#000;margin:0;padding:0}a{color:#087da1;font-family:BentonGothic,Open Sans,OpenSans,open-sans,helvetica neue,helvetica,sans-serif;text-decoration:underline}button:hover{cursor:pointer}input{border-radius:4px;font-size:1.125rem;height:56px;line-height:1;margin-bottom:10px;max-height:56px;width:100%}input:invalid{box-shadow:none}.ncm-container{background:#fff;border:1px solid #999;height:auto;margin:0 auto;max-height:95vh;max-width:700px;min-width:344px;padding:20px;position:fixed;width:90vw}.ncm-content{font-size:1.125rem;height:auto;margin:40px 0 0;padding:0;width:100%}@media only screen and (min-width:568px)and (max-width:768px){.ncm-content{margin-top:20px}}.ncm-close-button{background:transparent none;border:0;height:22px;padding:2px;position:absolute;right:22px}.ncm-close-icon{height:100%}.ncm-logo{margin-top:20px;width:100%}@media only screen and (min-width:568px)and (max-width:768px){.ncm-logo{margin-top:0}}.ncm-logo img{display:block;height:26px;margin:0 auto;width:auto}@media only screen and (min-width:568px)and (max-width:768px){.ncm-logo img{height:20px}}h3{font-family:BentonGothicCond-Black,Open Sans Condensed,OpenSansCondensed,open-sans-condensed,helvetica neue,helvetica,sans-serif;font-size:2.5rem;text-align:center;width:100%}@media only screen and (max-width:768px){h3{font-size:1.75rem}}.ncm-title{margin-bottom:20px}.ncm-thank-you{margin-bottom:30px;margin-top:96px}@media only screen and (min-width:568px)and (max-width:768px){.ncm-thank-you{margin-top:66px}}.ncm-success-links{font-family:BentonGothic,Open Sans,OpenSans,open-sans,helvetica neue,helvetica,sans-serif;font-size:18px;font-weight:500;line-height:26px;margin:0 auto 142px;max-width:560px;text-align:center;width:100%}@media only screen and (min-width:568px)and (max-width:768px){.ncm-success-links{margin-bottom:70px}}.ncm-text{margin-bottom:30px;max-width:680px}@media only screen and (min-width:568px)and (max-width:768px){.ncm-text{margin-bottom:15px}}.ncm-text p{font-family:BentonGothic,Open Sans,OpenSans,open-sans,helvetica neue,helvetica,sans-serif;margin:0 auto 13px;text-align:center}@media only screen and (min-width:568px)and (max-width:768px){.ncm-text p{margin-bottom:10px}}@media only screen and (max-width:768px){.ncm-text p{font-size:1rem}}.ncm-form{font-family:BentonGothic,Open Sans,OpenSans,open-sans,helvetica neue,helvetica,sans-serif;margin:0 auto 1rem;width:100%}@media only screen and (min-width:568px)and (max-width:768px){.ncm-form{display:block;max-width:100%;overflow:auto}}@media only screen and (min-width:768px){.ncm-form{max-width:326px}}.ncm-form input{display:block;font-family:BentonGothic,Open Sans,OpenSans,open-sans,helvetica neue,helvetica,sans-serif;text-align:center}@media only screen and (max-width:768px){.ncm-form input{font-size:1rem}}.ncm-input-wrapper{border:1px solid #757575;border-radius:4px;height:56px;margin-bottom:1rem;max-height:56px;padding:3px;width:100%}.ncm-input-wrapper.focus{border:2px solid #333;padding:2px}.ncm-input-wrapper.error{border:2px solid #e12327;border-radius:4px 4px 0 0;margin-bottom:0}.ncm-input-wrapper.error .ncm-email-input{border:1px solid #ccc}.ncm-input-error{background:#e12327;border-radius:0 0 4px 4px;color:#fff;display:none;font-size:.75rem;padding:8px 15px 7px;position:relative;text-transform:uppercase;top:-2px;width:100%}.ncm-email-input{border:0;color:#333;height:100%;padding:20px}.ncm-email-input::-moz-placeholder{color:#333!important}.ncm-email-input::placeholder{color:#333!important}.ncm-submit-button{background:#087da1;border:1px solid #087da1;border-radius:4px;color:#fff;display:block;font-size:1.125rem;font-weight:500;height:54px;line-height:1;margin-bottom:1rem;text-transform:uppercase;width:100%}.ncm-submit-button:hover{background:#076583;border:1px solid #076583}.ncm-submit-button:disabled{background:#757575;border-color:#757575;cursor:not-allowed}@media only screen and (min-width:568px)and (max-width:768px){.ncm-submit-button{display:inline-block;float:left;width:50%}}.ncm-not-interested-button{background-color:transparent;border:0;color:#087da1;display:block;font-size:18px;margin-bottom:1rem;text-align:center;width:100%}.ncm-not-interested-button:hover,.ncm-not-interested-button:hover span{color:#076583}.ncm-not-interested-button span{color:#087da1;text-decoration:underline}@media only screen and (min-width:568px)and (max-width:768px){.ncm-not-interested-button{display:inline-block;float:left;margin:15px 0;width:50%}}.ncm-form-error{color:#e12327;display:none;font-family:BentonGothic,Open Sans,OpenSans,open-sans,helvetica neue,helvetica,sans-serif;font-size:14px;font-weight:700;line-height:20px;margin-bottom:1rem}.ncm-form-error:before{background:#e12327;border-radius:100px;color:#fff;content:"!";display:inline-block;height:22px;line-height:1.35rem;margin-right:.5rem;text-align:center;width:22px}.ncm-disclaimer{margin:0 auto 50px;width:100%}.ncm-disclaimer p{color:#757575;font-family:BentonGothic,Open Sans,OpenSans,open-sans,helvetica neue,helvetica,sans-serif;font-size:12px;line-height:18px;margin-bottom:8.75px;text-align:center}@media only screen and (max-width:768px){.ncm-disclaimer p{text-align:left}}</style>\n      ${e.preventClose?"":'\n        <button id="ncm-close-button" class="ncm-button ncm-close-button" aria-label="Close">\n          <svg class="ncm-icon ncm-close-icon" viewBox="0 0 60 60">\n            <line x1="3" x2="57" y1="3" y2="57" opacity="1" fill-opacity="0" stroke="#757575" stroke-width="6" stroke-opacity="1" stroke-linecap="round"/>\n            <line x1="57" x2="3" y1="3" y2="57" opacity="1" fill-opacity="0" stroke="#757575" stroke-width="6" stroke-opacity="1" stroke-linecap="round"/>\n          </svg>\n        </button>\n      '}\n      ${e.campaignLogoUrl?`<div class="ncm-logo"><img src="${e.campaignLogoUrl}" alt="newsletter campaign logo"/></div>`:""}\n      <div id="ncm-content" class="ncm-content">\n        <h3 class="ncm-title">${e.title}</h3>\n        <div class="ncm-text">\n          ${e.subHeadline1?`<p class="ncm-subHeadline ncm-subHeadline1">${e.subHeadline1}</p>`:""}\n          ${e.subHeadline2?`<p class="ncm-subHeadline ncm-subHeadline2">${e.subHeadline2}</p>`:""}\n        </div>\n        <form id="ncm-form" class="ncm-form" method="post" action="${e.newsletterServiceUrl}">\n          ${C?"":'\n            <div class="ncm-input-wrapper">\n              <label class="visually-hidden" for="ncm-email-input">Email</label>\n              <input\n                type="email"\n                name="emailInput"\n                id="ncm-email-input"\n                class="ncm-email-input"\n                placeholder="Enter email address"\n                required\n              />\n            </div>\n            <div id="ncm-input-error" class="ncm-input-error"></div>\n          '}\n          <input type="hidden" name="newsletterId" value="${e.newsletterId}"/>\n          <input type="hidden" name="signUpSource" value="campaign-manager"/>\n          <button id="ncm-subscribe-button" class="ncm-button ncm-submit-button" type="submit">Sign Me Up</button>\n          ${e.preventClose?"":'\n            <button id="ncm-not-interested-button" class="ncm-button ncm-not-interested-button" type="button">\n              <span>I am not interested</span>\n            </button>\n          '}\n          <div class="ncm-form-error"></div>\n        </form>\n        <div class="ncm-disclaimer">\n          ${e.customDisclaimer?`<p>${e.customDisclaimer}</p>`:""}\n          <p>You may occasionally receive promotional content from the ${e.marketName}.</p>\n        </div>\n      </div>\n    `,i=document.createElement("div");return i.classList.add("ncm-container"),i.innerHTML=t,i}static attachEventListeners(e,t){var i,n;r("attachEventListeners");try{const s=e.querySelector("#ncm-form");if(!s)throw"Could not find NCM sign up form.";if(s.addEventListener("submit",(e=>{d.submit(e,t)})),!C){const e=e=>{var t;const i=e.target;null===(t=null==i?void 0:i.closest("div.ncm-input-wrapper"))||void 0===t||t.classList.toggle("focus"),d.removeInputError(s.emailInput)};s.emailInput.addEventListener("focus",e),s.emailInput.addEventListener("blur",e),s.emailInput.addEventListener("invalid",(e=>{e.preventDefault();const t=e.target;t.value?t.validationMessage&&d.showInputError(t,"Please enter a valid email address"):d.showInputError(t,"* Required")}))}const o=t=>{t.preventDefault(),e.close()};return t.preventClose||(null===(i=e.querySelector("#ncm-close-button"))||void 0===i||i.addEventListener("click",o),null===(n=e.querySelector("#ncm-not-interested-button"))||void 0===n||n.addEventListener("click",o)),!0}catch(t){return console.error(t),e.close(),!1}}static showInputError(e,t){const i=e.closest("div.ncm-input-wrapper");null==i||i.classList.remove("focus"),null==i||i.classList.add("error");const n=null==i?void 0:i.nextElementSibling;n&&(n.style.display="block",n.innerHTML=t)}static removeInputError(e){const t=e.closest("div.ncm-input-wrapper");null==t||t.classList.remove("error");const i=null==t?void 0:t.nextElementSibling;i&&(i.style.display="none",i.innerHTML="")}static showFormError(e,t){const i=e.querySelector(".ncm-form-error");i&&(i.style.display="block",i.innerHTML=t)}static removeFormError(e){const t=e.querySelector(".ncm-form-error");t&&(t.innerHTML="",t.style.display="none")}static submit(e,t){var i,n,s,r;return l(this,void 0,void 0,(function*(){e.preventDefault();const a=e.target;d.toggleButton(a),d.removeFormError(a);const c={data:{id:a.newsletterId.value,type:"newsletter"},meta:{signUpSource:a.signUpSource.value,email:(null===(i=a.emailInput)||void 0===i?void 0:i.value)||void 0}};try{const e=yield $.makeApiRequest(t.newsletterServiceUrl,{method:"POST",body:JSON.stringify(c)});o("subscribe"),d.showSuccess(a),t.onSuccess&&"function"==typeof t.onSuccess&&t.onSuccess(e)}catch(e){console.error("Error subscribing reader to newsletter",e),d.showFormError(a,null!==(r=null===(s=null===(n=null==e?void 0:e.errors)||void 0===n?void 0:n[0])||void 0===s?void 0:s.detail)&&void 0!==r?r:"Unfortunately, there was a problem subscribing you to the newsletter"),d.toggleButton(a),t.onError&&"function"==typeof t.onError&&t.onError(e)}}))}static toggleButton(e){const t=e.querySelector("#ncm-subscribe-button");if(t){if(t.getAttribute("disabled"))return t.removeAttribute("disabled"),void(t.innerHTML="Sign Me Up");t.setAttribute("disabled","true"),t.innerHTML="Submitting ..."}}static showSuccess(e){const t=e.action,i=t.substring(t.indexOf("/subscription-services/v1"),-1);if(C)n=t=>l(this,void 0,void 0,(function*(){const n=t.user.getEmailAddress();d.renderSuccessMessage(e,n,i)})),(window.registration||(window.registration=[])).push(n);else{const t=e.emailInput.value;d.renderSuccessMessage(e,t,i)}var n}static renderSuccessMessage(e,t,i){const n=e.parentElement;n&&(n.innerHTML=`\n      <h3 class="ncm-thank-you">Thank you for signing up.</h3>\n      <div class="ncm-success-links">\n          You've signed up ${t} successfully. <a href="${i}/newsletters" target="_blank">Manage all your newsletters here.</a>\n      </div>\n    `)}static render(e){return new Promise((t=>{(window.meteringjs||(window.meteringjs=[])).push({status:i=>{(function(e,t,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(e):n?n.value:t.get(e)})(d,a,"m",c).call(d,e,t)}})}))}}a=d,c=function(e,t){var i;r("pushToModality",e,t);const n=null!==(i=e.modalityOptions)&&void 0!==i?i:{},{afterOpen:s}=n,o=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(n,["afterOpen"]);(window.modality||(window.modality=[])).push(Object.assign({name:"newsletter-campaign",component:"Modal",blocking:!1,content:d.buildHtmlElement(e),afterOpen:i=>{s&&"function"==typeof s&&s(i),t(d.attachEventListeners(i,e))},useShadowRoot:!0},o))};const u=window.localStorage;class h{static getFullKey(e){return`caltimes.ncm.${e}`}static storeWithExpiry(e,t,i){if(u)try{const n=h.getFullKey(e),s={value:t,expiry:(new Date).getTime()+i.getTimeOffset()};u.setItem(n,JSON.stringify(s))}catch(e){console.error(e)}}static updateKeyValue(e,t){if(u){r("updateKeyValue",e,t);try{const i=h.getFullKey(e),n=h.retrieveWithExpiry(e);n&&(n.value=t,u.setItem(i,JSON.stringify(n)))}catch(e){console.error(e)}}}static retrieveWithExpiry(e){if(!u)return null;r("retrieveWithExpiry",e);try{r("retrieving from local storage",e);const t=h.getFullKey(e),i=u.getItem(t);return i?JSON.parse(i):null}catch(e){return console.error(e),null}}static deleteKey(e){if(u){r("deleteKey",e);try{r("deleting from local storage",e);const t=h.getFullKey(e);u.removeItem(t)}catch(e){console.error(e)}}}static cookieExists(e){return document.cookie.indexOf(`${e}=`)>=0}static getCookieValue(e){var t;const i=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return i&&null!==(t=i.pop())&&void 0!==t?t:""}}const m="campaignsShown",p=/Googlebot|AdsBot-Google|Pingdom/i,v="c_nSubs",g="session";class b{constructor(e=0,t=0,i=0){this.minutes=e,this.hours=t,this.days=i}static isPastExpiry(e){return!(!e||!e.expiry)&&(new Date).getTime()>=e.expiry}getTimeOffset(){return 60*(60*(24*this.days+this.hours)+this.minutes)*1e3}}var f,w,y,x,E,T,k,L,I,S,O,M,A,B=function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function r(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,a)}c((n=n.apply(e,t||[])).next())}))},D=function(e,t,i,n){if("a"===i&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?n:"a"===i?n.call(e):n?n.value:t.get(e)},j=function(e,t,i,n,s){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!s)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,i):s?s.value=i:t.set(e,i),i};const C=h.cookieExists("c_mId");class ${constructor(){var e;if(f.add(this),y.set(this,!1),x.set(this,!1),E.set(this,void 0),T.set(this,void 0),k.set(this,void 0),L.set(this,void 0),I.set(this,[]),window.newsletterCampaignSettings&&!(null===(e=window.newsletterCampaignSettings)||void 0===e?void 0:e.disabled)){const e=()=>{window.scrollY>0&&(setTimeout((()=>{this.push(window.newsletterCampaignSettings)}),1e3),document.removeEventListener("scroll",e))};document.addEventListener("scroll",e)}Array.isArray(window.ncm)&&window.ncm.length&&this.push(window.ncm.pop()),window.ncm=this}get isDebug(){return D(this,y,"f")}get userIsExcluded(){return D($,w,"m",O).call($)}get userIsSubscribed(){return!!D(this,L,"f")&&D(this,I,"f").includes(D(this,L,"f").newsletterId)}get hasSeenCampaign(){var e,t;if(!D(this,L,"f"))return!1;const i=null!==(t=null===(e=D(this,T,"f"))||void 0===e?void 0:e.value)&&void 0!==t?t:[];return i.length>0&&i.some((e=>e===D(this,L,"f").newsletterId))}static makeApiRequest(e,t={}){return B(this,void 0,void 0,(function*(){const i=yield fetch(e,Object.assign(Object.assign({},t),{credentials:"include"})),n=yield i.json();if(!i.ok)throw n;return n}))}push(e){var t,i,n;return B(this,void 0,void 0,(function*(){j(this,x,!!e.disabled,"f"),j(this,y,!(!e.debug&&!(null===(t=e.bounceTracker)||void 0===t?void 0:t.debug)),"f"),r("Push received",e),D(this,x,"f")?r("Campaign disabled, skipping"):this.userIsExcluded?r("Skipping campaign because the reader is excluded from newsletter campaigns."):e.campaign?(D(this,k,"f")&&(D(this,k,"f").disable(),j(this,k,void 0,"f")),j(this,L,e.campaign,"f"),j(this,E,null!==(i=e.bounceTracker)&&void 0!==i?i:void 0,"f"),j(this,I,yield D($,w,"m",S).call($,D(this,L,"f").newsletterServiceUrl),"f"),j(this,T,h.retrieveWithExpiry(m),"f"),D(this,T,"f")&&!b.isPastExpiry(D(this,T,"f"))||h.storeWithExpiry(m,[],new b(0,0,3)),this.hasSeenCampaign?r(`Skipping campaign ${D(this,L,"f").newsletterId} has already been shown. Set to expire on ${null===(n=D(this,T,"f"))||void 0===n?void 0:n.expiry}.`):this.userIsSubscribed?r(`Skipping campaign because the reader is already subscribed to campaign ${D(this,L,"f").newsletterId}.`):h.retrieveWithExpiry(g)||(h.storeWithExpiry(g,{seen:!0},new b(0,0,730)),e.campaign.preventClose)?D(this,E,"f")?D(this,f,"m",M).call(this):D(this,f,"m",A).call(this):r(`Skipping campaign ${D(this,L,"f").newsletterId} because this is a brand new user session.`)):r("Newsletter campaign missing from settings. Skipping.")}))}}w=$,y=new WeakMap,x=new WeakMap,E=new WeakMap,T=new WeakMap,k=new WeakMap,L=new WeakMap,I=new WeakMap,f=new WeakSet,S=function(e){return B(this,void 0,void 0,(function*(){if(C&&!h.cookieExists(v))try{yield $.makeApiRequest(e)}catch(e){return console.error("Failed to fetch newsletter subscriptions",e),[]}const t=h.getCookieValue(v);try{return t?JSON.parse(decodeURIComponent(t)):[]}catch(e){return console.error(e),[]}}))},O=function(){return!(!window.Scroll||!h.cookieExists("scroll0"))||!!navigator.userAgent.match(p)},M=function(){var e,t;const i=Object.assign(Object.assign({},D(this,E,"f")),{bounceAction:()=>{D(this,f,"m",A).call(this)},probability:C?null===(e=D(this,E,"f"))||void 0===e?void 0:e.probability:1,debug:null!==(t=D(this,y,"f"))&&void 0!==t&&t});j(this,k,new s(i),"f")},A=function(){var e,t,i;return B(this,void 0,void 0,(function*(){if(r("showNewsletterCampaign()",D(this,x,"f"),D(this,L,"f")),D(this,L,"f")&&(yield d.render(D(this,L,"f")))){if(r("campaign rendered",D(this,L,"f")),!(null===(e=D(this,L,"f"))||void 0===e?void 0:e.preventCampaignTracking)){const e=null!==(i=null===(t=D(this,T,"f"))||void 0===t?void 0:t.value)&&void 0!==i?i:[];e.push(D(this,L,"f").newsletterId),h.updateKeyValue(m,e)}o("shown")}}))};const P=()=>{new $};document&&"loading"===document.readyState?document.addEventListener("DOMContentLoaded",P):P()})()})();